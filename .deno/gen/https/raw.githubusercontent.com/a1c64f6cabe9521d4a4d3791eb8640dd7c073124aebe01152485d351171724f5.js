import { eventHandlers } from "../../bot.ts";
import { cacheHandlers } from "../../cache.ts";
import { snowflakeToBigint } from "../../util/bigint.ts";
export async function handleMessageDelete(data) {
    const payload = data.d;
    const channel = await cacheHandlers.get("channels", snowflakeToBigint(payload.channelId));
    if (!channel) return;
    eventHandlers.messageDelete?.({
        id: payload.id,
        channel
    }, await cacheHandlers.get("messages", snowflakeToBigint(payload.id)));
    await cacheHandlers.delete("messages", snowflakeToBigint(payload.id));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjxodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGlzY29yZGVuby9kaXNjb3JkZW5vL21haW4vc3JjL2hhbmRsZXJzL21lc3NhZ2VzL01FU1NBR0VfREVMRVRFLnRzPiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBldmVudEhhbmRsZXJzIH0gZnJvbSBcIi4uLy4uL2JvdC50c1wiO1xuaW1wb3J0IHsgY2FjaGVIYW5kbGVycyB9IGZyb20gXCIuLi8uLi9jYWNoZS50c1wiO1xuaW1wb3J0IHR5cGUgeyBEaXNjb3JkR2F0ZXdheVBheWxvYWQgfSBmcm9tIFwiLi4vLi4vdHlwZXMvZ2F0ZXdheS9nYXRld2F5X3BheWxvYWQudHNcIjtcbmltcG9ydCB0eXBlIHsgTWVzc2FnZURlbGV0ZSB9IGZyb20gXCIuLi8uLi90eXBlcy9tZXNzYWdlcy9tZXNzYWdlX2RlbGV0ZS50c1wiO1xuaW1wb3J0IHsgc25vd2ZsYWtlVG9CaWdpbnQgfSBmcm9tIFwiLi4vLi4vdXRpbC9iaWdpbnQudHNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZU1lc3NhZ2VEZWxldGUoZGF0YTogRGlzY29yZEdhdGV3YXlQYXlsb2FkKSB7XG4gIGNvbnN0IHBheWxvYWQgPSBkYXRhLmQgYXMgTWVzc2FnZURlbGV0ZTtcbiAgY29uc3QgY2hhbm5lbCA9IGF3YWl0IGNhY2hlSGFuZGxlcnMuZ2V0KFxuICAgIFwiY2hhbm5lbHNcIixcbiAgICBzbm93Zmxha2VUb0JpZ2ludChwYXlsb2FkLmNoYW5uZWxJZCksXG4gICk7XG4gIGlmICghY2hhbm5lbCkgcmV0dXJuO1xuXG4gIGV2ZW50SGFuZGxlcnMubWVzc2FnZURlbGV0ZT8uKFxuICAgIHsgaWQ6IHBheWxvYWQuaWQsIGNoYW5uZWwgfSxcbiAgICBhd2FpdCBjYWNoZUhhbmRsZXJzLmdldChcIm1lc3NhZ2VzXCIsIHNub3dmbGFrZVRvQmlnaW50KHBheWxvYWQuaWQpKSxcbiAgKTtcblxuICBhd2FpdCBjYWNoZUhhbmRsZXJzLmRlbGV0ZShcIm1lc3NhZ2VzXCIsIHNub3dmbGFrZVRvQmlnaW50KHBheWxvYWQuaWQpKTtcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiU0FBUyxhQUFhLFNBQVEsWUFBYztTQUNuQyxhQUFhLFNBQVEsY0FBZ0I7U0FHckMsaUJBQWlCLFNBQVEsb0JBQXNCO3NCQUVsQyxtQkFBbUIsQ0FBQyxJQUEyQjtVQUM3RCxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQUM7VUFDaEIsT0FBTyxTQUFTLGFBQWEsQ0FBQyxHQUFHLEVBQ3JDLFFBQVUsR0FDVixpQkFBaUIsQ0FBQyxPQUFPLENBQUMsU0FBUztTQUVoQyxPQUFPO0lBRVosYUFBYSxDQUFDLGFBQWE7UUFDdkIsRUFBRSxFQUFFLE9BQU8sQ0FBQyxFQUFFO1FBQUUsT0FBTzthQUNuQixhQUFhLENBQUMsR0FBRyxFQUFDLFFBQVUsR0FBRSxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsRUFBRTtVQUc1RCxhQUFhLENBQUMsTUFBTSxFQUFDLFFBQVUsR0FBRSxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsRUFBRSJ9