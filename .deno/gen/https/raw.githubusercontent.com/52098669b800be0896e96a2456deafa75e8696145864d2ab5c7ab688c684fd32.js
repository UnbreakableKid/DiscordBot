import { eventHandlers } from "../bot.ts";
import { cache } from "../cache.ts";
import { channelOverwriteHasPermission } from "../helpers/channels/channel_overwrite_has_permission.ts";
import { cloneChannel } from "../helpers/channels/clone_channel.ts";
import { deleteChannel } from "../helpers/channels/delete_channel.ts";
import { deleteChannelOverwrite } from "../helpers/channels/delete_channel_overwrite.ts";
import { editChannel } from "../helpers/channels/edit_channel.ts";
import { editChannelOverwrite } from "../helpers/channels/edit_channel_overwrite.ts";
import { sendMessage } from "../helpers/messages/send_message.ts";
import { disconnectMember } from "../helpers/mod.ts";
import { snowflakeToBigint } from "../util/bigint.ts";
import { Collection } from "../util/collection.ts";
import { createNewProp } from "../util/utils.ts";
const CHANNEL_SNOWFLAKES = [
    "id",
    "guildId",
    "lastMessageId",
    "ownerId",
    "applicationId",
    "parentId", 
];
const baseChannel = {
    get guild () {
        return cache.guilds.get(this.guildId);
    },
    get messages () {
        return cache.messages.filter((m)=>m.channelId === this.id
        );
    },
    get mention () {
        return `<#${this.id}>`;
    },
    get voiceStates () {
        return this.guild?.voiceStates.filter((voiceState)=>voiceState.channelId === this.id
        );
    },
    get connectedMembers () {
        const voiceStates = this.voiceStates;
        if (!voiceStates) return undefined;
        return new Collection(voiceStates.map((vs)=>[
                vs.userId,
                cache.members.get(vs.userId)
            ]
        ));
    },
    send (content) {
        return sendMessage(this.id, content);
    },
    disconnect (memberId) {
        return disconnectMember(this.guildId, memberId);
    },
    delete (reason) {
        return deleteChannel(this.id, reason);
    },
    editOverwrite (id, options) {
        return editChannelOverwrite(this.guildId, this.id, id, options);
    },
    deleteOverwrite (id) {
        return deleteChannelOverwrite(this.guildId, this.id, id);
    },
    hasPermission (overwrites, permissions) {
        return channelOverwriteHasPermission(this.guildId, this.id, overwrites, permissions);
    },
    edit (options, reason) {
        return editChannel(this.id, options, reason);
    },
    clone (reason) {
        return cloneChannel(this.id, reason);
    }
};
/** Create a structure object  */ // deno-lint-ignore require-await
export async function createDiscordenoChannel(data, guildId) {
    const { lastPinTimestamp , permissionOverwrites =[] , ...rest } = data;
    const props = {
    };
    Object.entries(rest).forEach(([key, value])=>{
        eventHandlers.debug?.("loop", `Running forEach loop in createDiscordenoChannel function.`);
        props[key] = createNewProp(CHANNEL_SNOWFLAKES.includes(key) ? value ? snowflakeToBigint(value) : undefined : value);
    });
    // Set the guildId seperately because sometimes guildId is not included
    props.guildId = createNewProp(snowflakeToBigint(guildId?.toString() || data.guildId || ""));
    const channel = Object.create(baseChannel, {
        ...props,
        lastPinTimestamp: createNewProp(lastPinTimestamp ? Date.parse(lastPinTimestamp) : undefined),
        permissionOverwrites: createNewProp(permissionOverwrites.map((o)=>({
                ...o,
                id: snowflakeToBigint(o.id),
                allow: snowflakeToBigint(o.allow),
                deny: snowflakeToBigint(o.deny)
            })
        ))
    });
    return channel;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjxodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGlzY29yZGVuby9kaXNjb3JkZW5vL21haW4vc3JjL3N0cnVjdHVyZXMvY2hhbm5lbC50cz4iXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXZlbnRIYW5kbGVycyB9IGZyb20gXCIuLi9ib3QudHNcIjtcbmltcG9ydCB7IGNhY2hlIH0gZnJvbSBcIi4uL2NhY2hlLnRzXCI7XG5pbXBvcnQgeyBjaGFubmVsT3ZlcndyaXRlSGFzUGVybWlzc2lvbiB9IGZyb20gXCIuLi9oZWxwZXJzL2NoYW5uZWxzL2NoYW5uZWxfb3ZlcndyaXRlX2hhc19wZXJtaXNzaW9uLnRzXCI7XG5pbXBvcnQgeyBjbG9uZUNoYW5uZWwgfSBmcm9tIFwiLi4vaGVscGVycy9jaGFubmVscy9jbG9uZV9jaGFubmVsLnRzXCI7XG5pbXBvcnQgeyBkZWxldGVDaGFubmVsIH0gZnJvbSBcIi4uL2hlbHBlcnMvY2hhbm5lbHMvZGVsZXRlX2NoYW5uZWwudHNcIjtcbmltcG9ydCB7IGRlbGV0ZUNoYW5uZWxPdmVyd3JpdGUgfSBmcm9tIFwiLi4vaGVscGVycy9jaGFubmVscy9kZWxldGVfY2hhbm5lbF9vdmVyd3JpdGUudHNcIjtcbmltcG9ydCB7IGVkaXRDaGFubmVsIH0gZnJvbSBcIi4uL2hlbHBlcnMvY2hhbm5lbHMvZWRpdF9jaGFubmVsLnRzXCI7XG5pbXBvcnQgeyBlZGl0Q2hhbm5lbE92ZXJ3cml0ZSB9IGZyb20gXCIuLi9oZWxwZXJzL2NoYW5uZWxzL2VkaXRfY2hhbm5lbF9vdmVyd3JpdGUudHNcIjtcbmltcG9ydCB7IHNlbmRNZXNzYWdlIH0gZnJvbSBcIi4uL2hlbHBlcnMvbWVzc2FnZXMvc2VuZF9tZXNzYWdlLnRzXCI7XG5pbXBvcnQgeyBkaXNjb25uZWN0TWVtYmVyIH0gZnJvbSBcIi4uL2hlbHBlcnMvbW9kLnRzXCI7XG5pbXBvcnQgdHlwZSB7IENoYW5uZWwgfSBmcm9tIFwiLi4vdHlwZXMvY2hhbm5lbHMvY2hhbm5lbC50c1wiO1xuaW1wb3J0IHR5cGUgeyBNb2RpZnlDaGFubmVsIH0gZnJvbSBcIi4uL3R5cGVzL2NoYW5uZWxzL21vZGlmeV9jaGFubmVsLnRzXCI7XG5pbXBvcnQgdHlwZSB7XG4gIERpc2NvcmRPdmVyd3JpdGUsXG4gIE92ZXJ3cml0ZSxcbn0gZnJvbSBcIi4uL3R5cGVzL2NoYW5uZWxzL292ZXJ3cml0ZS50c1wiO1xuaW1wb3J0IHR5cGUgeyBDcmVhdGVNZXNzYWdlIH0gZnJvbSBcIi4uL3R5cGVzL21lc3NhZ2VzL2NyZWF0ZV9tZXNzYWdlLnRzXCI7XG5pbXBvcnQgdHlwZSB7IFBlcm1pc3Npb25TdHJpbmdzIH0gZnJvbSBcIi4uL3R5cGVzL3Blcm1pc3Npb25zL3Blcm1pc3Npb25fc3RyaW5ncy50c1wiO1xuaW1wb3J0IHsgc25vd2ZsYWtlVG9CaWdpbnQgfSBmcm9tIFwiLi4vdXRpbC9iaWdpbnQudHNcIjtcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tIFwiLi4vdXRpbC9jb2xsZWN0aW9uLnRzXCI7XG5pbXBvcnQgeyBjcmVhdGVOZXdQcm9wIH0gZnJvbSBcIi4uL3V0aWwvdXRpbHMudHNcIjtcbmltcG9ydCB7IERpc2NvcmRlbm9HdWlsZCB9IGZyb20gXCIuL2d1aWxkLnRzXCI7XG5pbXBvcnQgeyBEaXNjb3JkZW5vTWVtYmVyIH0gZnJvbSBcIi4vbWVtYmVyLnRzXCI7XG5pbXBvcnQgeyBEaXNjb3JkZW5vTWVzc2FnZSB9IGZyb20gXCIuL21lc3NhZ2UudHNcIjtcbmltcG9ydCB7IERpc2NvcmRlbm9Wb2ljZVN0YXRlIH0gZnJvbSBcIi4vdm9pY2Vfc3RhdGUudHNcIjtcblxuY29uc3QgQ0hBTk5FTF9TTk9XRkxBS0VTID0gW1xuICBcImlkXCIsXG4gIFwiZ3VpbGRJZFwiLFxuICBcImxhc3RNZXNzYWdlSWRcIixcbiAgXCJvd25lcklkXCIsXG4gIFwiYXBwbGljYXRpb25JZFwiLFxuICBcInBhcmVudElkXCIsXG5dO1xuXG5jb25zdCBiYXNlQ2hhbm5lbDogUGFydGlhbDxEaXNjb3JkZW5vQ2hhbm5lbD4gPSB7XG4gIGdldCBndWlsZCgpIHtcbiAgICByZXR1cm4gY2FjaGUuZ3VpbGRzLmdldCh0aGlzLmd1aWxkSWQhKTtcbiAgfSxcbiAgZ2V0IG1lc3NhZ2VzKCkge1xuICAgIHJldHVybiBjYWNoZS5tZXNzYWdlcy5maWx0ZXIoKG0pID0+IG0uY2hhbm5lbElkID09PSB0aGlzLmlkISk7XG4gIH0sXG4gIGdldCBtZW50aW9uKCkge1xuICAgIHJldHVybiBgPCMke3RoaXMuaWQhfT5gO1xuICB9LFxuICBnZXQgdm9pY2VTdGF0ZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ3VpbGQ/LnZvaWNlU3RhdGVzLmZpbHRlcihcbiAgICAgICh2b2ljZVN0YXRlKSA9PiB2b2ljZVN0YXRlLmNoYW5uZWxJZCA9PT0gdGhpcy5pZCEsXG4gICAgKTtcbiAgfSxcbiAgZ2V0IGNvbm5lY3RlZE1lbWJlcnMoKSB7XG4gICAgY29uc3Qgdm9pY2VTdGF0ZXMgPSB0aGlzLnZvaWNlU3RhdGVzO1xuICAgIGlmICghdm9pY2VTdGF0ZXMpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oXG4gICAgICB2b2ljZVN0YXRlcy5tYXAoKHZzKSA9PiBbdnMudXNlcklkLCBjYWNoZS5tZW1iZXJzLmdldCh2cy51c2VySWQpXSksXG4gICAgKTtcbiAgfSxcbiAgc2VuZChjb250ZW50KSB7XG4gICAgcmV0dXJuIHNlbmRNZXNzYWdlKHRoaXMuaWQhLCBjb250ZW50KTtcbiAgfSxcbiAgZGlzY29ubmVjdChtZW1iZXJJZCkge1xuICAgIHJldHVybiBkaXNjb25uZWN0TWVtYmVyKHRoaXMuZ3VpbGRJZCEsIG1lbWJlcklkKTtcbiAgfSxcbiAgZGVsZXRlKHJlYXNvbikge1xuICAgIHJldHVybiBkZWxldGVDaGFubmVsKHRoaXMuaWQhLCByZWFzb24pO1xuICB9LFxuICBlZGl0T3ZlcndyaXRlKGlkLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGVkaXRDaGFubmVsT3ZlcndyaXRlKHRoaXMuZ3VpbGRJZCEsIHRoaXMuaWQhLCBpZCwgb3B0aW9ucyk7XG4gIH0sXG4gIGRlbGV0ZU92ZXJ3cml0ZShpZCkge1xuICAgIHJldHVybiBkZWxldGVDaGFubmVsT3ZlcndyaXRlKHRoaXMuZ3VpbGRJZCEsIHRoaXMuaWQhLCBpZCk7XG4gIH0sXG4gIGhhc1Blcm1pc3Npb24ob3ZlcndyaXRlcywgcGVybWlzc2lvbnMpIHtcbiAgICByZXR1cm4gY2hhbm5lbE92ZXJ3cml0ZUhhc1Blcm1pc3Npb24oXG4gICAgICB0aGlzLmd1aWxkSWQhLFxuICAgICAgdGhpcy5pZCEsXG4gICAgICBvdmVyd3JpdGVzLFxuICAgICAgcGVybWlzc2lvbnMsXG4gICAgKTtcbiAgfSxcbiAgZWRpdChvcHRpb25zLCByZWFzb24pIHtcbiAgICByZXR1cm4gZWRpdENoYW5uZWwodGhpcy5pZCEsIG9wdGlvbnMsIHJlYXNvbik7XG4gIH0sXG4gIGNsb25lKHJlYXNvbikge1xuICAgIHJldHVybiBjbG9uZUNoYW5uZWwodGhpcy5pZCEsIHJlYXNvbik7XG4gIH0sXG59O1xuXG4vKiogQ3JlYXRlIGEgc3RydWN0dXJlIG9iamVjdCAgKi9cbi8vIGRlbm8tbGludC1pZ25vcmUgcmVxdWlyZS1hd2FpdFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZURpc2NvcmRlbm9DaGFubmVsKGRhdGE6IENoYW5uZWwsIGd1aWxkSWQ/OiBiaWdpbnQpIHtcbiAgY29uc3QgeyBsYXN0UGluVGltZXN0YW1wLCBwZXJtaXNzaW9uT3ZlcndyaXRlcyA9IFtdLCAuLi5yZXN0IH0gPSBkYXRhO1xuXG4gIGNvbnN0IHByb3BzOiBSZWNvcmQ8c3RyaW5nLCBQcm9wZXJ0eURlc2NyaXB0b3I+ID0ge307XG4gIE9iamVjdC5lbnRyaWVzKHJlc3QpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgIGV2ZW50SGFuZGxlcnMuZGVidWc/LihcbiAgICAgIFwibG9vcFwiLFxuICAgICAgYFJ1bm5pbmcgZm9yRWFjaCBsb29wIGluIGNyZWF0ZURpc2NvcmRlbm9DaGFubmVsIGZ1bmN0aW9uLmAsXG4gICAgKTtcblxuICAgIHByb3BzW2tleV0gPSBjcmVhdGVOZXdQcm9wKFxuICAgICAgQ0hBTk5FTF9TTk9XRkxBS0VTLmluY2x1ZGVzKGtleSlcbiAgICAgICAgPyB2YWx1ZSA/IHNub3dmbGFrZVRvQmlnaW50KHZhbHVlKSA6IHVuZGVmaW5lZFxuICAgICAgICA6IHZhbHVlLFxuICAgICk7XG4gIH0pO1xuXG4gIC8vIFNldCB0aGUgZ3VpbGRJZCBzZXBlcmF0ZWx5IGJlY2F1c2Ugc29tZXRpbWVzIGd1aWxkSWQgaXMgbm90IGluY2x1ZGVkXG4gIHByb3BzLmd1aWxkSWQgPSBjcmVhdGVOZXdQcm9wKFxuICAgIHNub3dmbGFrZVRvQmlnaW50KGd1aWxkSWQ/LnRvU3RyaW5nKCkgfHwgZGF0YS5ndWlsZElkIHx8IFwiXCIpLFxuICApO1xuXG4gIGNvbnN0IGNoYW5uZWw6IERpc2NvcmRlbm9DaGFubmVsID0gT2JqZWN0LmNyZWF0ZShiYXNlQ2hhbm5lbCwge1xuICAgIC4uLnByb3BzLFxuICAgIGxhc3RQaW5UaW1lc3RhbXA6IGNyZWF0ZU5ld1Byb3AoXG4gICAgICBsYXN0UGluVGltZXN0YW1wID8gRGF0ZS5wYXJzZShsYXN0UGluVGltZXN0YW1wKSA6IHVuZGVmaW5lZCxcbiAgICApLFxuICAgIHBlcm1pc3Npb25PdmVyd3JpdGVzOiBjcmVhdGVOZXdQcm9wKFxuICAgICAgcGVybWlzc2lvbk92ZXJ3cml0ZXMubWFwKChvKSA9PiAoe1xuICAgICAgICAuLi5vLFxuICAgICAgICBpZDogc25vd2ZsYWtlVG9CaWdpbnQoby5pZCksXG4gICAgICAgIGFsbG93OiBzbm93Zmxha2VUb0JpZ2ludChvLmFsbG93KSxcbiAgICAgICAgZGVueTogc25vd2ZsYWtlVG9CaWdpbnQoby5kZW55KSxcbiAgICAgIH0pKSxcbiAgICApLFxuICB9KTtcblxuICByZXR1cm4gY2hhbm5lbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEaXNjb3JkZW5vQ2hhbm5lbCBleHRlbmRzXG4gIE9taXQ8XG4gICAgQ2hhbm5lbCxcbiAgICB8IFwiaWRcIlxuICAgIHwgXCJndWlsZElkXCJcbiAgICB8IFwibGFzdE1lc3NhZ2VJZFwiXG4gICAgfCBcIm93bmVySWRcIlxuICAgIHwgXCJhcHBsaWNhdGlvbklkXCJcbiAgICB8IFwicGFyZW50SWRcIlxuICAgIHwgXCJwZXJtaXNzaW9uT3ZlcndyaXRlc1wiXG4gID4ge1xuICBwZXJtaXNzaW9uT3ZlcndyaXRlczogKE9taXQ8RGlzY29yZE92ZXJ3cml0ZSwgXCJpZFwiIHwgXCJhbGxvd1wiIHwgXCJkZW55XCI+ICYge1xuICAgIGlkOiBiaWdpbnQ7XG4gICAgYWxsb3c6IGJpZ2ludDtcbiAgICBkZW55OiBiaWdpbnQ7XG4gIH0pW107XG4gIC8qKiBUaGUgaWQgb2YgdGhlIGNoYW5uZWwgKi9cbiAgaWQ6IGJpZ2ludDtcbiAgLyoqIFRoZSBpZCBvZiB0aGUgZ3VpbGQsIDBuIGlmIGl0IGlzIGEgRE0gKi9cbiAgZ3VpbGRJZDogYmlnaW50O1xuICAvKiogVGhlIGlkIG9mIHRoZSBsYXN0IG1lc3NhZ2Ugc2VudCBpbiB0aGlzIGNoYW5uZWwgKG1heSBub3QgcG9pbnQgdG8gYW4gZXhpc3Rpbmcgb3IgdmFsaWQgbWVzc2FnZSkgKi9cbiAgbGFzdE1lc3NhZ2VJZD86IGJpZ2ludDtcbiAgLyoqIGlkIG9mIHRoZSBETSBjcmVhdG9yICovXG4gIG93bmVySWQ/OiBiaWdpbnQ7XG4gIC8qKiBBcHBsaWNhdGlvbiBpZCBvZiB0aGUgZ3JvdXAgRE0gY3JlYXRvciBpZiBpdCBpcyBib3QtY3JlYXRlZCAqL1xuICBhcHBsaWNhdGlvbklkPzogYmlnaW50O1xuICAvKiogSWQgb2YgdGhlIHBhcmVudCBjYXRlZ29yeSBmb3IgYSBjaGFubmVsIChlYWNoIHBhcmVudCBjYXRlZ29yeSBjYW4gY29udGFpbiB1cCB0byA1MCBjaGFubmVscykgKi9cbiAgcGFyZW50SWQ/OiBiaWdpbnQ7XG4gIC8vIEdFVFRFUlNcblxuICAvKipcbiAgICogR2V0cyB0aGUgZ3VpbGQgb2JqZWN0IGZvciB0aGlzIGNoYW5uZWwuXG4gICAqXG4gICAqIOKaoO+4jyBBRFZBTkNFRDogSWYgeW91IHVzZSB0aGUgY3VzdG9tIGNhY2hlLCB0aGVzZSB3aWxsIG5vdCB3b3JrIGZvciB5b3UuIEdldHRlcnMgY2FuIG5vdCBiZSBhc3luYyBhbmQgY3VzdG9tIGNhY2hlIHJlcXVpcmVzIGFzeW5jLlxuICAgKi9cbiAgZ3VpbGQ/OiBEaXNjb3JkZW5vR3VpbGQ7XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBtZXNzYWdlcyBmcm9tIGNhY2hlIHRoYXQgd2VyZSBzZW50IGluIHRoaXMgY2hhbm5lbFxuICAgKlxuICAgKiDimqDvuI8gQURWQU5DRUQ6IElmIHlvdSB1c2UgdGhlIGN1c3RvbSBjYWNoZSwgdGhlc2Ugd2lsbCBub3Qgd29yayBmb3IgeW91LiBHZXR0ZXJzIGNhbiBub3QgYmUgYXN5bmMgYW5kIGN1c3RvbSBjYWNoZSByZXF1aXJlcyBhc3luYy5cbiAgICovXG4gIG1lc3NhZ2VzOiBDb2xsZWN0aW9uPGJpZ2ludCwgRGlzY29yZGVub01lc3NhZ2U+O1xuICAvKiogVGhlIG1lbnRpb24gb2YgdGhlIGNoYW5uZWwgKi9cbiAgbWVudGlvbjogc3RyaW5nO1xuICAvKipcbiAgICogR2V0cyB0aGUgdm9pY2Ugc3RhdGVzIGZvciB0aGlzIGNoYW5uZWxcbiAgICpcbiAgICog4pqg77iPIEFEVkFOQ0VEOiBJZiB5b3UgdXNlIHRoZSBjdXN0b20gY2FjaGUsIHRoZXNlIHdpbGwgbm90IHdvcmsgZm9yIHlvdS4gR2V0dGVycyBjYW4gbm90IGJlIGFzeW5jIGFuZCBjdXN0b20gY2FjaGUgcmVxdWlyZXMgYXN5bmMuXG4gICAqL1xuICB2b2ljZVN0YXRlcz86IENvbGxlY3Rpb248YmlnaW50LCBEaXNjb3JkZW5vVm9pY2VTdGF0ZT47XG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb25uZWN0ZWQgbWVtYmVycyBmb3IgdGhpcyBjaGFubmVsIHVuZGVmaW5lZCBpZiBtZW1iZXIgaXMgbm90IGNhY2hlZFxuICAgKlxuICAgKiDimqDvuI8gQURWQU5DRUQ6IElmIHlvdSB1c2UgdGhlIGN1c3RvbSBjYWNoZSwgdGhlc2Ugd2lsbCBub3Qgd29yayBmb3IgeW91LiBHZXR0ZXJzIGNhbiBub3QgYmUgYXN5bmMgYW5kIGN1c3RvbSBjYWNoZSByZXF1aXJlcyBhc3luYy5cbiAgICovXG4gIGNvbm5lY3RlZE1lbWJlcnM/OiBDb2xsZWN0aW9uPGJpZ2ludCwgRGlzY29yZGVub01lbWJlciB8IHVuZGVmaW5lZD47XG5cbiAgLy8gTUVUSE9EU1xuXG4gIC8qKiBTZW5kIGEgbWVzc2FnZSB0byB0aGUgY2hhbm5lbC4gUmVxdWlyZXMgU0VORF9NRVNTQUdFUyBwZXJtaXNzaW9uLiAqL1xuICBzZW5kKGNvbnRlbnQ6IHN0cmluZyB8IENyZWF0ZU1lc3NhZ2UpOiBSZXR1cm5UeXBlPHR5cGVvZiBzZW5kTWVzc2FnZT47XG4gIC8qKiBEaXNjb25uZWN0IGEgbWVtYmVyIGZyb20gYSB2b2ljZSBjaGFubmVsLiBSZXF1aXJlcyBNT1ZFX01FTUJFUlMgcGVybWlzc2lvbi4gKi9cbiAgZGlzY29ubmVjdChtZW1iZXJJZDogYmlnaW50KTogUmV0dXJuVHlwZTx0eXBlb2YgZGlzY29ubmVjdE1lbWJlcj47XG4gIC8qKiBEZWxldGUgdGhlIGNoYW5uZWwgKi9cbiAgZGVsZXRlKHJlYXNvbj86IHN0cmluZyk6IFJldHVyblR5cGU8dHlwZW9mIGRlbGV0ZUNoYW5uZWw+O1xuICAvKiogRWRpdCBhIGNoYW5uZWwgT3ZlcndyaXRlICovXG4gIGVkaXRPdmVyd3JpdGUoXG4gICAgb3ZlcndyaXRlSWQ6IGJpZ2ludCxcbiAgICBvcHRpb25zOiBPbWl0PE92ZXJ3cml0ZSwgXCJpZFwiPixcbiAgKTogUmV0dXJuVHlwZTx0eXBlb2YgZWRpdENoYW5uZWxPdmVyd3JpdGU+O1xuICAvKiogRGVsZXRlIGEgY2hhbm5lbCBPdmVyd3JpdGUgKi9cbiAgZGVsZXRlT3ZlcndyaXRlKFxuICAgIG92ZXJ3cml0ZUlkOiBiaWdpbnQsXG4gICk6IFJldHVyblR5cGU8dHlwZW9mIGRlbGV0ZUNoYW5uZWxPdmVyd3JpdGU+O1xuICAvKiogQ2hlY2tzIGlmIGEgY2hhbm5lbCBvdmVyd3JpdGUgZm9yIGEgdXNlciBpZCBvciBhIHJvbGUgaWQgaGFzIHBlcm1pc3Npb24gaW4gdGhpcyBjaGFubmVsICovXG4gIGhhc1Blcm1pc3Npb24oXG4gICAgb3ZlcndyaXRlczogKE9taXQ8RGlzY29yZE92ZXJ3cml0ZSwgXCJpZFwiIHwgXCJhbGxvd1wiIHwgXCJkZW55XCI+ICYge1xuICAgICAgaWQ6IGJpZ2ludDtcbiAgICAgIGFsbG93OiBiaWdpbnQ7XG4gICAgICBkZW55OiBiaWdpbnQ7XG4gICAgfSlbXSxcbiAgICBwZXJtaXNzaW9uczogUGVybWlzc2lvblN0cmluZ3NbXSxcbiAgKTogUmV0dXJuVHlwZTx0eXBlb2YgY2hhbm5lbE92ZXJ3cml0ZUhhc1Blcm1pc3Npb24+O1xuICAvKiogRWRpdCB0aGUgY2hhbm5lbCAqL1xuICBlZGl0KG9wdGlvbnM6IE1vZGlmeUNoYW5uZWwsIHJlYXNvbj86IHN0cmluZyk6IFJldHVyblR5cGU8dHlwZW9mIGVkaXRDaGFubmVsPjtcbiAgLyoqIENyZWF0ZSBhIG5ldyBjaGFubmVsIHdpdGggdGhlIHNhbWUgcHJvcGVydGllcyAqL1xuICBjbG9uZShyZWFzb24/OiBzdHJpbmcpOiBSZXR1cm5UeXBlPHR5cGVvZiBjbG9uZUNoYW5uZWw+O1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJTQUFTLGFBQWEsU0FBUSxTQUFXO1NBQ2hDLEtBQUssU0FBUSxXQUFhO1NBQzFCLDZCQUE2QixTQUFRLHVEQUF5RDtTQUM5RixZQUFZLFNBQVEsb0NBQXNDO1NBQzFELGFBQWEsU0FBUSxxQ0FBdUM7U0FDNUQsc0JBQXNCLFNBQVEsK0NBQWlEO1NBQy9FLFdBQVcsU0FBUSxtQ0FBcUM7U0FDeEQsb0JBQW9CLFNBQVEsNkNBQStDO1NBQzNFLFdBQVcsU0FBUSxtQ0FBcUM7U0FDeEQsZ0JBQWdCLFNBQVEsaUJBQW1CO1NBUzNDLGlCQUFpQixTQUFRLGlCQUFtQjtTQUM1QyxVQUFVLFNBQVEscUJBQXVCO1NBQ3pDLGFBQWEsU0FBUSxnQkFBa0I7TUFNMUMsa0JBQWtCO0tBQ3RCLEVBQUk7S0FDSixPQUFTO0tBQ1QsYUFBZTtLQUNmLE9BQVM7S0FDVCxhQUFlO0tBQ2YsUUFBVTs7TUFHTixXQUFXO1FBQ1gsS0FBSztlQUNBLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxNQUFNLE9BQU87O1FBRWxDLFFBQVE7ZUFDSCxLQUFLLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUssQ0FBQyxDQUFDLFNBQVMsVUFBVSxFQUFFOzs7UUFFekQsT0FBTztnQkFDRCxFQUFFLE9BQU8sRUFBRSxDQUFFLENBQUM7O1FBRXBCLFdBQVc7b0JBQ0QsS0FBSyxFQUFFLFdBQVcsQ0FBQyxNQUFNLEVBQ2xDLFVBQVUsR0FBSyxVQUFVLENBQUMsU0FBUyxVQUFVLEVBQUU7OztRQUdoRCxnQkFBZ0I7Y0FDWixXQUFXLFFBQVEsV0FBVzthQUMvQixXQUFXLFNBQVMsU0FBUzttQkFFdkIsVUFBVSxDQUNuQixXQUFXLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQU0sRUFBRSxDQUFDLE1BQU07Z0JBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLE1BQU07Ozs7SUFHbkUsSUFBSSxFQUFDLE9BQU87ZUFDSCxXQUFXLE1BQU0sRUFBRSxFQUFHLE9BQU87O0lBRXRDLFVBQVUsRUFBQyxRQUFRO2VBQ1YsZ0JBQWdCLE1BQU0sT0FBTyxFQUFHLFFBQVE7O0lBRWpELE1BQU0sRUFBQyxNQUFNO2VBQ0osYUFBYSxNQUFNLEVBQUUsRUFBRyxNQUFNOztJQUV2QyxhQUFhLEVBQUMsRUFBRSxFQUFFLE9BQU87ZUFDaEIsb0JBQW9CLE1BQU0sT0FBTyxPQUFRLEVBQUUsRUFBRyxFQUFFLEVBQUUsT0FBTzs7SUFFbEUsZUFBZSxFQUFDLEVBQUU7ZUFDVCxzQkFBc0IsTUFBTSxPQUFPLE9BQVEsRUFBRSxFQUFHLEVBQUU7O0lBRTNELGFBQWEsRUFBQyxVQUFVLEVBQUUsV0FBVztlQUM1Qiw2QkFBNkIsTUFDN0IsT0FBTyxPQUNQLEVBQUUsRUFDUCxVQUFVLEVBQ1YsV0FBVzs7SUFHZixJQUFJLEVBQUMsT0FBTyxFQUFFLE1BQU07ZUFDWCxXQUFXLE1BQU0sRUFBRSxFQUFHLE9BQU8sRUFBRSxNQUFNOztJQUU5QyxLQUFLLEVBQUMsTUFBTTtlQUNILFlBQVksTUFBTSxFQUFFLEVBQUcsTUFBTTs7O0FBSXhDLEVBQWlDLEFBQWpDLDZCQUFpQyxBQUFqQyxFQUFpQyxDQUNqQyxFQUFpQyxBQUFqQywrQkFBaUM7c0JBQ1gsdUJBQXVCLENBQUMsSUFBYSxFQUFFLE9BQWdCO1lBQ25FLGdCQUFnQixHQUFFLG9CQUFvQixVQUFVLElBQUksS0FBSyxJQUFJO1VBRS9ELEtBQUs7O0lBQ1gsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsT0FBTyxHQUFHLEdBQUcsRUFBRSxLQUFLO1FBQ3ZDLGFBQWEsQ0FBQyxLQUFLLElBQ2pCLElBQU0sSUFDTCx5REFBeUQ7UUFHNUQsS0FBSyxDQUFDLEdBQUcsSUFBSSxhQUFhLENBQ3hCLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQzNCLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxLQUFLLElBQUksU0FBUyxHQUM1QyxLQUFLOztJQUliLEVBQXVFLEFBQXZFLHFFQUF1RTtJQUN2RSxLQUFLLENBQUMsT0FBTyxHQUFHLGFBQWEsQ0FDM0IsaUJBQWlCLENBQUMsT0FBTyxFQUFFLFFBQVEsTUFBTSxJQUFJLENBQUMsT0FBTztVQUdqRCxPQUFPLEdBQXNCLE1BQU0sQ0FBQyxNQUFNLENBQUMsV0FBVztXQUN2RCxLQUFLO1FBQ1IsZ0JBQWdCLEVBQUUsYUFBYSxDQUM3QixnQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixJQUFJLFNBQVM7UUFFN0Qsb0JBQW9CLEVBQUUsYUFBYSxDQUNqQyxvQkFBb0IsQ0FBQyxHQUFHLEVBQUUsQ0FBQzttQkFDdEIsQ0FBQztnQkFDSixFQUFFLEVBQUUsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQzFCLEtBQUssRUFBRSxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsS0FBSztnQkFDaEMsSUFBSSxFQUFFLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxJQUFJOzs7O1dBSzdCLE9BQU8ifQ==